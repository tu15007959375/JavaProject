# Nacos注册中心
## 主要解决问题
假如微服务被调用较多，为了应对更高的并发，进行了多实例部署
此时，每个微服务的实例其IP或端口不同，问题来了：
- 这么多实例，如何知道每一个实例的地址？
- http请求要写url地址，服务到底该调用哪个实例呢？
- 如果在运行过程中，某一个实例宕机，依然在调用该怎么办？
- 如果并发太高，临时多部署了N台实例，如何知道新实例的地址？
## 原理
在微服务远程调用的过程中，包括两个角色：
- 服务提供者：提供接口供其它微服务访问
- 服务消费者：调用其它微服务提供的接口
在大型微服务项目中，服务提供者的数量会非常多，为了管理这些服务就引入了注册中心的概念。注册中心、服务提供者、服务消费者三者间关系如下：
![nacosFlow.jfif](/mymd/imgs/512c06eb-3269-4872-8d3e-7d5dbca14480nacosFlow.jfif)
流程如下：
- 服务启动时就会注册自己的服务信息（服务名、IP、端口）到注册中心
- 调用者可以从注册中心订阅想要的服务，获取服务对应的实例列表（1个服务可能多实例部署）
- 调用者自己对实例列表负载均衡，挑选一个实例
- 调用者向该实例发起远程调用

当服务提供者的实例宕机或者启动新实例时，调用者如何得知呢？
- 服务提供者会定期向注册中心发送请求，报告自己的健康状态（心跳请求）
- 当注册中心长时间收不到提供者的心跳时，会认为该实例宕机，将其从服务的实例列表中剔除
- 当服务有新实例启动时，会发送注册服务请求，其信息会被记录在注册中心的服务实例列表
- 当注册中心服务列表变更时，会主动通知微服务，更新本地服务列表